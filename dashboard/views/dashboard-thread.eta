<%~ includeFile("partials/header.eta"); %>
<%~ includeFile("partials/message.eta"); %>
<%
	const { threadID } = threadData; 
%>

<div class="bg-primary text-white py-3">
  <div class="container">
    <h6 class="text-white">
      <a class="text-white" href="/dashboard" style="text-decoration: none;"><i class="fas fa-cog "></i>
        Dashboard</a>
    </h6>
  </div>
</div>

<form id="setData" class="container">
	<!-- show box name and box id -->
  <br>
	<!-- border radius -->
	<div class="alert alert-primary d-flex justify-content-center d-flex flex-column align-items-center rounded-5">
		<h5 class="alert-heading">Box Name: <%= threadData.threadName %></h5>
		<p class="mt-2">Box ID: <%= threadData.threadID %></p>
	</div>
<!-- 	
  <p class="text-success">Box Name: <%=threadData.threadName || "null" %>
  </p>
  <p class="text-info">Box ID: <%=threadID%>
  </p> -->

  <div class="jwvIWx">
    <div class="dwztKr" href="<%= '/dashboard/' + threadID + '/welcome' %>">
      <div class="jSrukW">
        <label class="switch">
          <input class="form-check-input" type="checkbox" id="sw-welcome" <%=
						threadData.settings.sendWelcomeMessage ? 'checked' : '' %>>
          <span class="slider round"></span>
        </label>
      </div>
      <h5>ğŸ‘‹ Welcome</h5>
      <div class="bEBnTb ms-1">Gá»­i tin nháº¯n chÃ o má»«ng thÃ nh viÃªn má»›i!</div>
    </div>

    <div class="dwztKr" href="<%= '/dashboard/' + threadID + '/leave' %>">
      <div class="jSrukW">
        <label class="switch">
          <input type="checkbox" id="sw-leave" <%= threadData.settings.sendLeaveMessage ? 'checked' : '' %>>
          <span class="slider round"></span>
        </label>
      </div>
      <h5 class="bEBnTb">ğŸ¤§ Leave</h5>
      <div class="bEBnTb ms-1">Gá»­i tin nháº¯n táº¡m biá»‡t thÃ nh viÃªn rá»i khá»i nhÃ³m!</div>
    </div>

    <div class="dwztKr" href="<%= '/dashboard/' + threadID + '/rankup' %>">
      <div class="jSrukW">
        <label class="switch">
          <input type="checkbox" id="sw-rankup" <%= threadData.settings.sendRankupMessage ? 'checked' : '' %>>
          <span class="slider round"></span>
        </label>
      </div>
      <h5 class="bEBnTb">ğŸ† Rankup</h5>
      <div class="bEBnTb ms-1">Gá»­i tin nháº¯n thÃ´ng bÃ¡o thÄƒng cáº¥p!</div>
    </div>

    <div class="dwztKr" href="<%= '/dashboard/' + threadID + '/custom-cmd' %>">
      <div class="jSrukW">
        <label class="switch">
          <input type="checkbox" name="customCommand" id="sw-customcmd" <%= threadData.settings.customCommand
						? 'checked' : '' %>>
          <span class="slider round"></span>
        </label>

      </div>
      <h5 class="bEBnTb">âš™ï¸ Custom command</h5>
      <div class="bEBnTb ms-1">TÃ¹y chá»‰nh lá»‡nh cá»§a bot!</div>
    </div>

    <input type="hidden" name="threadID" value="<%= threadID %>">
    <button type="submit" id="save" class="btn btn-primary btn-block" <%=authConfigDashboard ? '' : 'disabled'%>>LÆ°u</button>

  </div>
</form>

<script type="text/javascript">
  (function() {
    const btn = $("#save");
    btn.on("click", function(e) {
      e.preventDefault();
      '<% if (authConfigDashboard) { %>'
      $.ajax({
        url: "/api/thread/setData/settings",
        type: "POST",
        data: {
          threadID: "<%= threadID %>",
          updateData: {
            sendWelcomeMessage: $("#sw-welcome").is(":checked"),
            sendLeaveMessage: $("#sw-leave").is(":checked"),
            sendRankupMessage: $("#sw-rankup").is(":checked"),
            customCommand: $("#sw-customcmd").is(":checked")
          }
        },
        success: function(data) {
          $.createToast({
            title: "Success",
            type: "success",
            message: "Cáº­p nháº­t thÃ nh cÃ´ng!"
          })
        },
        error: function(err) {
          $.createToast({
            title: "Lá»—i",
            type: "error",
            message: "ÄÃ£ xáº£y ra lá»—i!"
          })
        }
      });
      '<% } else { %>'
      e.preventDefault();
      $.createToast({
        title: "Warnig",
        message: "[!] Chá»‰ quáº£n trá»‹ viÃªn cá»§a nhÃ³m chat hoáº·c nhá»¯ng thÃ nh viÃªn Ä‘Æ°á»£c cho phÃ©p má»›i cÃ³ thá»ƒ chá»‰nh sá»­a dashboard",
        type: "warning",
      })
      '<% } %>'
    });

    $(".dwztKr").on("click", function(e) {
      if (e.target.type !== "checkbox" && e.target.className !== "slider round") window.location.href = this.getAttribute("href");
    });
  })();
</script>
<%~ includeFile("partials/footer.eta") %>